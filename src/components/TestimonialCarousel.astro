---
// No changes to the component's script part.
---
<div class="carousel-container">
	<div class="testimonial-track">
		<div class="testimonial-slide">
			<p>"Dan has been an excellent help for me as I am studying A-Level engineering. He helped me to understand the mathematics involved with the subject that I couldnt understand from just the college lessons alone. His teaching methods are very clear and easy to follow and he can explain things in multiple different ways to make things easier to understand."</p>
			<p class="author">Dan M. - A-Level Student</p>
		</div>
		<div class="testimonial-slide">
			<p>"Kai has been tutoring my daughter, who is currently in Year 10, to prepare her for GCSE English for the past few months. I have found him to be highly motivated, meticulous, and knowledgeable. My daughter thoroughly enjoys his lessons and I can already see a positive impact on her understanding and confidence in such a short period. I am more than happy to recommend him as an excellent tutor."</p>
			<p class="author">Thoibe T. - GCSE Student</p>
		</div>
		<div class="testimonial-slide">
			<p>"Dan is tutoring both my sons. He has built up a positive relationship with them and they both feel they are benefiting from their sessions. Both my sons have additional needs and present very differently to each other. Dan has adapted how he delivers the sessions to meet their needs. Dan has been very communicative with me in terms of how they are doing and flexible when I need to postpone a session or add an extra one. I highly recommend his sessions."</p>
			<p class="author">Lyn R. - Parent of GCSE Students</p>
		</div>
		<div class="testimonial-slide">
			<p>"I've really enjoyed working with Dan as my maths tutor over the past couple of months. The sessions have been really helpful and supportive, and I feel so much more confident in my maths now. I'm really grateful for the progress I've made and would definitely recommend Dan to anyone looking for a great maths tutor."</p>
			<p class="author">Vi L. - GCSE Student</p>
		</div>
		<div class="testimonial-slide">
			<p>"I enjoyed my sessions with Dan a lot, he really helped with my general understanding of physics as well as how to answer exam questions. Overall I would definitely recommend Dan as he is also a very nice person to talk to as work with."</p>
			<p class="author">Callum C. - A Level Student</p>
		</div>
		<div class="testimonial-slide">
			<p>"I achieved grade 4 for both English language and literature. Thank you so much for your really helpful lessons. Although Kai didn't teach me for long, his lessons really helped me develop a lot in terms of results. Thank you so much."</p>
			<p class="author">Linh - GCSE Student</p>
		</div>
		<div class="testimonial-slide">
			<p>"Dan has been tutoring me for a few months now, and he's been amazing. We cover all the sciences and maths, which is really helpful when the teachers at school aren’t very clear. Each lesson, I choose one of the four subjects to focus on, and we go over things I find difficult or that would be useful for future exams. What I like most is that he never makes me feel bad for not knowing something or getting a question wrong. Instead, we work together to find ways to help me remember how to solve it or structure an answer."</p>
			<p class="author">Mina J. - GCSE Student</p>
		</div>
		<div class="testimonial-slide">
			<p>"During my GCSEs Dan was an absolute life-saver! I was really struggling with my physics at GCSE level however once Dan came along I started to understand the content more and even delve into more information my teacher hadn’t introduced me to. Without him I really struggled with physics and couldn’t get my head round it however over time he helped me grasp the idea of physics and the content within, eventually resulting to my 9-9 in physics. He’s an amazing tutor and such a lovely person we always have great conversations alongside my learning! I can’t wait to continue working with him at a levels I couldn’t recommend him anymore!"</p>
			<p class="author">Evan C. - GCSE Student</p>
		</div>
		<div class="testimonial-slide">
			<p>"Thank-you for all your help running up to my A level. You were able to make me understand things clearer and I felt more confident going into my exam. I was able to achieve 2 grades higher than what I was predicted. Thanks again and I would highly recommend you to other students."</p>
			<p class="author">Evie D. - A-Level Student</p>
		</div>
	</div>
</div>
<div class="carousel-nav">
	<button id="prevBtn" class="carousel-button">‹</button>
	<button id="nextBtn" class="carousel-button">›</button>
</div>

<style>
	/* --- Carousel Styles --- */
	.carousel-container {
		width: 100%;
		margin: 2em 0;
		overflow: hidden;
		box-sizing: border-box;
	}

	.testimonial-track {
		display: flex;
		align-items: center;
		transition: transform 0.5s ease-in-out;
	}

	.testimonial-slide {
		flex: 0 0 auto;
		width: auto;
		max-width: 600px;
		padding: 1.5em;
		text-align: center;
		border: 1px solid #ddd;
		border-radius: 8px;
		margin: 0 10px;
		box-sizing: border-box;
		background-color: #ffffffff;
		box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
		transition: transform 0.5s ease-in-out, opacity 0.5s ease-in-out, box-shadow 0.5s ease-in-out;
	}
	
	.testimonial-slide.is-active {
		transform: scale(1);
		opacity: 1;
		box-shadow: 0 8px 15px rgba(0, 0, 0, 0.15);
	}
	
	.testimonial-slide:not(.is-active) {
		transform: scale(0.8);
		opacity: 0.6;
	}

	.testimonial-slide p {
		font-style: italic;
		color: var(--accent);
	}

	.testimonial-slide .author {
		font-weight: bold;
		font-style: normal;
		margin-top: 1em;
	}

	.carousel-nav {
		text-align: center;
		margin-top: 1em;
	}

	.carousel-button {
		background-color: transparent;
		color: var(--accent);
		border: 2px solid var(--accent);
		font-size: 1.5em;
		cursor: pointer;
		border-radius: 50%;
		width: 45px;
		height: 45px;
		margin: 0 10px;
		transition: all 0.3s ease;
	}
	
	.carousel-button:hover {
		background-color: var(--accent);
		color: white;
		transform: translateY(-2px);
	}

	.carousel-button:active {
		transform: translateY(-1px) scale(0.98);
	}

	/* --- Tablet Responsive Styles --- */
	@media (max-width: 768px) {
		.testimonial-slide {
			max-width: 80%;
			margin: 0 10px;
		}
	}

	/* --- Mobile Responsive Styles --- */
	@media (max-width: 480px) {
		.carousel-container {
			padding: 0;
		}
		.testimonial-slide {
			max-width: 90%;
			margin: 0 5px;
		}
	}
</style>

<script is:inline>
document.addEventListener('DOMContentLoaded', () => {
	function debounce(func, wait) {
		let timeout;
		return function executedFunction(...args) {
			const later = () => {
				clearTimeout(timeout);
				func(...args);
			};
			clearTimeout(timeout);
			timeout = setTimeout(later, wait);
		};
	}

	const container = document.querySelector('.carousel-container');
	const track = document.querySelector('.testimonial-track');
	const prevButton = document.getElementById('prevBtn');
	const nextButton = document.getElementById('nextBtn');
	
	if (!track || !container) return;

	let slides = Array.from(track.children);
	const originalSlideCount = slides.length;
	let isTransitioning = false;
	
	const clonesCount = 2;

	for (let i = 0; i < clonesCount; i++) {
		const index = originalSlideCount - 1 - i;
		const clone = slides[index].cloneNode(true);
		clone.classList.add('clone');
		track.insertBefore(clone, slides[0]);
	}
	for (let i = 0; i < clonesCount; i++) {
		const clone = slides[i].cloneNode(true);
		clone.classList.add('clone');
		track.appendChild(clone);
	}

	slides = Array.from(track.children);
	let currentIndex = clonesCount;

	let slideOffsets = [];

	let autoPlayInterval;
	const autoPlayDelay = 10000;

	let touchStartX = 0;
	let touchEndX = 0;
	const swipeThreshold = 50;

	const updateSlideClasses = () => {
		slides.forEach((slide, index) => {
			if (index === currentIndex) {
				slide.classList.add('is-active');
			} else {
				slide.classList.remove('is-active');
			}
		});
	};

	const calculateSlideDimensions = () => {
		slideOffsets = [];
		let currentOffset = 0;
		for (const slide of slides) {
			slideOffsets.push(currentOffset);
			const slideStyle = window.getComputedStyle(slide);
			const slideMarginLeft = parseInt(slideStyle.marginLeft, 10);
			const slideMarginRight = parseInt(slideStyle.marginRight, 10);
			currentOffset += slide.offsetWidth + slideMarginLeft + slideMarginRight;
		}
	};


	const setPosition = (instant = false) => {
		if (instant) track.style.transition = 'none';

		const currentSlide = slides[currentIndex];
		if (!currentSlide) return;

		const containerWidth = container.clientWidth;
		const currentSlideWidth = currentSlide.offsetWidth;
		const centeringOffset = (containerWidth - currentSlideWidth) / 2;
		const targetOffset = slideOffsets[currentIndex] || 0;
		
		const offset = centeringOffset - targetOffset;
		track.style.transform = `translateX(${offset}px)`;

		if (instant) {
			setTimeout(() => {
				track.style.transition = 'transform 0.5s ease-in-out, opacity 0.5s ease-in-out';
			}, 50);
		}
	};
	
	const moveTo = (newIndex) => {
		if (isTransitioning) return;
		isTransitioning = true;
		currentIndex = newIndex;
		setPosition();
		updateSlideClasses();
	};

	const startAutoPlay = () => {
		clearInterval(autoPlayInterval);
		setInterval(() => {
			moveTo(currentIndex + 1);
		}, autoPlayDelay);
	};

	nextButton.addEventListener('click', () => {
		moveTo(currentIndex + 1);
		startAutoPlay();
	});

	prevButton.addEventListener('click', () => {
		moveTo(currentIndex - 1);
		startAutoPlay();
	});

	container.addEventListener('touchstart', (e) => {
		touchStartX = e.changedTouches[0].screenX;
	});

	container.addEventListener('touchend', (e) => {
		touchEndX = e.changedTouches[0].screenX;
		const deltaX = touchEndX - touchStartX;

		if (Math.abs(deltaX) > swipeThreshold) {
			moveTo(deltaX > 0 ? currentIndex - 1 : currentIndex + 1);
			startAutoPlay();
		}
	});

	track.addEventListener('transitionend', () => {
		if (currentIndex >= originalSlideCount + clonesCount) {
			currentIndex = clonesCount;
			setPosition(true);
			updateSlideClasses();
		}
		if (currentIndex < clonesCount) {
			currentIndex = originalSlideCount + clonesCount - 1;
			setPosition(true);
			updateSlideClasses();
		}
		isTransitioning = false;
	});

	container.addEventListener('mouseenter', () => {
		clearInterval(autoPlayInterval);
	});

	container.addEventListener('mouseleave', () => {
		startAutoPlay();
	});

	// --- Initial Setup ---
	calculateSlideDimensions();
	setPosition(true);
	updateSlideClasses();
	startAutoPlay();

	window.addEventListener('resize', debounce(() => {
		calculateSlideDimensions();
		setPosition(true);
		startAutoPlay();
	}, 250));
});
</script>

