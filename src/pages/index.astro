---
import BaseHead from '../components/BaseHead.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import { SITE_TITLE, SITE_DESCRIPTION } from '../consts';
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
	</head>
	<body>
		<Header />
		<main>
			<h1>New Leaf Academy</h1>
			<p class="tagline">
			- Grow with Confidence
			</p>
			<p>
			Unlock potential with expert online tutoring. ðŸŽ“ Personalized, confidence-building tuition in Maths, English, Science, & more, from KS3 to A-level.
			</p>
		</main>

		<div class="carousel-container">
			<div class="testimonial-track">
				<div class="testimonial-slide">
					<p>"Dan has been an excellent help for me as I am studying A-Level engineering. He helped me to understand the mathematics involved with the subject that I couldnt understand from just the college lessons alone. His teaching methods are very clear and easy to follow and he can explain things in multiple different ways to make things easier to understand."</p>
					<p class="author">- Dan M.</p>
				</div>
				<div class="testimonial-slide">
					<p>"Dan is tutoring both my sons. He has built up a positive relationship with them and they both feel they are benefiting from their sessions. Both my sons have additional needs and present very differently to each other. Dan has adapted how he delivers the sessions to meet their needs. Dan has been very communicative with me in terms of how they are doing and flexible when I need to postpone a session or add an extra one. I highly recommend his sessions."</p>
					<p class="author">- Lyn R.</p>
				</div>
				<div class="testimonial-slide">
					<p>"I've really enjoyed working with Dan as my maths tutor over the past couple of months. The sessions have been really helpful and supportive, and I feel so much more confident in my maths now. I'm really grateful for the progress I've made and would definitely recommend Dan to anyone looking for a great maths tutor."</p>
					<p class="author">- Vi L.</p>
				</div>
				<div class="testimonial-slide">
					<p>"I enjoyed my sessions with Dan a lot, he really helped with my general understanding of physics as well as how to answer exam questions. Overall I would definitely recommend Dan as he is also a very nice person to talk to as work with."</p>
					<p class="author">- Callum C.</p>
				</div>
				<div class="testimonial-slide">
					<p>"Dan has been tutoring me for a few months now, and he's been amazing. We cover all the sciences and maths, which is really helpful when the teachers at school arenâ€™t very clear. Each lesson, I choose one of the four subjects to focus on, and we go over things I find difficult or that would be useful for future exams. What I like most is that he never makes me feel bad for not knowing something or getting a question wrong. Instead, we work together to find ways to help me remember how to solve it or structure an answer."</p>
					<p class="author">- Mina J.</p>
				</div>
				<div class="testimonial-slide">
					<p>"During my GCSEs Dan was an absolute life-saver! I was really struggling with my physics at GCSE level however once Dan came along I started to understand the content more and even delve into more information my teacher hadnâ€™t introduced me to. Without him I really struggled with physics and couldnâ€™t get my head round it however over time he helped me grasp the idea of physics and the content within, eventually resulting to my 9-9 in physics. Heâ€™s an amazing tutor and such a lovely person we always have great conversations alongside my learning! I canâ€™t wait to continue working with him at a levels I couldnâ€™t recommend him anymore!"</p>
					<p class="author">- Evan C.</p>
				</div>
				<div class="testimonial-slide">
					<p>"Thank-you for all your help running up to my A level. You were able to make me understand things clearer and I felt more confident going into my exam. I was able to achieve 2 grades higher than what I was predicted. Thanks again and I would highly recommend you to other students."</p>
					<p class="author">- Evie D.</p>
				</div>
			</div>
		</div>
		<div class="carousel-nav">
			<button id="prevBtn" class="carousel-button">â€¹</button>
			<button id="nextBtn" class="carousel-button">â€º</button>
		</div>
		<Footer />
	</body>
</html>

<style>
	main {
		color: #2c4fb9;
	}
	h1 {
		color: #2c4fb9 !important;
	}

	.tagline {
		font-size: 1.5em;
		font-weight: bold;
	}

	/* START: UPDATED CAROUSEL STYLES */
	.carousel-container {
		max-width: 1000px;
		margin: 2em auto 0;
		overflow: hidden; /* This hides the other slides */
		padding: 0 40px;
		box-sizing: border-box;
	}

	.testimonial-track {
		display: flex; /* Lay out slides horizontally */
		transition: transform 0.5s ease-in-out; /* Add smooth transition */
	}

	.testimonial-slide {
		flex: 0 0 100%; /* Default: show one slide at a time on mobile */
		width: 100%;
		padding: 1.5em;
		text-align: center;
		border: 1px solid #ddd;
		border-radius: 8px;
		margin-right: 20px;
	}
	
	.testimonial-slide p {
		font-style: italic;
	}

	.testimonial-slide .author {
		font-weight: bold;
		font-style: normal;
		margin-top: 1em;
	}

	/* Navigation buttons styling */
	.carousel-nav {
		text-align: center;
		margin-top: 1em;
	}

	.carousel-button {
		background-color: #2c4fb9;
		color: white;
		border: none;
		font-size: 1.5em;
		cursor: pointer;
		border-radius: 50%;
		width: 45px;
		height: 45px;
		margin: 0 10px;
		transition: background-color 0.3s;
	}
	
	.carousel-button:hover {
		background-color: #1a327b;
	}

	/* NEW: Media query for larger screens */
	@media (min-width: 768px) {
		.testimonial-slide {
			flex: 0 0 50%; /* Show two slides at a time on larger screens */
			width: 50%;
		}
	}
	/* END: UPDATED CAROUSEL STYLES */
</style>

<script>
	// START: UPDATED SCRIPT FOR INFINITE CAROUSEL
	document.addEventListener('DOMContentLoaded', () => {
		const track = document.querySelector('.testimonial-track');
		const prevButton = document.getElementById('prevBtn');
		const nextButton = document.getElementById('nextBtn');
		
		if (!track) return;

		let slides = Array.from(track.children);
		const originalSlideCount = slides.length;
		let isTransitioning = false;
		
		// 1. CLONE SLIDES for the infinite effect
		// How many slides to clone on each side.
		const clonesCount = 2;

		// Prepend clones from the end
		for (let i = 0; i < clonesCount; i++) {
			const index = originalSlideCount - 1 - i;
			const clone = slides[index].cloneNode(true);
			clone.classList.add('clone');
			track.insertBefore(clone, slides[0]);
		}
		// Append clones from the start
		for (let i = 0; i < clonesCount; i++) {
			const clone = slides[i].cloneNode(true);
			clone.classList.add('clone');
			track.appendChild(clone);
		}

		// Update our slides array to include the new clones
		slides = Array.from(track.children);
		
		// Start at the first "real" slide, which is after the prepended clones
		let currentIndex = clonesCount;

		const getSlideWidth = () => {
			return slides[0].clientWidth + 20; // slide width + 20px margin-right
		};

		// 2. POSITION the track to show the first real slide on load
		const setPosition = (instant = false) => {
			if (instant) track.style.transition = 'none';
			
			const offset = -currentIndex * getSlideWidth();
			track.style.transform = `translateX(${offset}px)`;

			// Use a timeout to re-enable transitions after an instant move
			if (instant) {
				setTimeout(() => {
					track.style.transition = 'transform 0.5s ease-in-out';
				}, 50);
			}
		};

		// 3. EVENT LISTENERS for buttons
		nextButton.addEventListener('click', () => {
			if (isTransitioning) return;
			isTransitioning = true;
			currentIndex++;
			setPosition();
		});

		prevButton.addEventListener('click', () => {
			if (isTransitioning) return;
			isTransitioning = true;
			currentIndex--;
			setPosition();
		});

		// 4. THE MAGIC: Listen for the end of a transition
		track.addEventListener('transitionend', () => {
			// Check if we've landed on a cloned slide at the end of the track
			if (currentIndex >= originalSlideCount + clonesCount) {
				// If so, jump back to the first "real" slide without an animation
				currentIndex = clonesCount;
				setPosition(true); // 'true' means instant jump
			}

			// Check if we've landed on a cloned slide at the beginning of the track
			if (currentIndex < clonesCount) {
				// If so, jump to the last "real" slide without an animation
				currentIndex = originalSlideCount + clonesCount - 1;
				setPosition(true); // 'true' means instant jump
			}
			
			isTransitioning = false; // Allow the next click
		});

		// Set the correct initial position when the page loads
		setPosition(true);

		// Recalculate and reset position on window resize
		window.addEventListener('resize', () => setPosition(true));
	});
	// END: UPDATED SCRIPT
</script>