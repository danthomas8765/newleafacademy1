---
import BaseHead from '../components/BaseHead.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import { SITE_TITLE, SITE_DESCRIPTION } from '../consts';
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
	</head>
	<body>
		<Header />
		<main>
			<h1>New Leaf Academy</h1>
			<p class="tagline">
			- Grow with Confidence
			</p>
			<p>
			Unlock potential with expert online tutoring. ðŸŽ“ Personalized, confidence-building tuition in Maths, English, Science, & more, from KS3 to A-level.
			</p>
		</main>

		<div class="carousel-container">
			<div class="testimonial-track">
				<div class="testimonial-slide">
					<p>"Dan has been an excellent help for me as I am studying A-Level engineering. He helped me to understand the mathematics involved with the subject that I couldnt understand from just the college lessons alone. His teaching methods are very clear and easy to follow and he can explain things in multiple different ways to make things easier to understand."</p>
					<p class="author">- Dan M.</p>
				</div>
				<div class="testimonial-slide">
					<p>"Dan is tutoring both my sons. He has built up a positive relationship with them and they both feel they are benefiting from their sessions. Both my sons have additional needs and present very differently to each other. Dan has adapted how he delivers the sessions to meet their needs. Dan has been very communicative with me in terms of how they are doing and flexible when I need to postpone a session or add an extra one. I highly recommend his sessions."</p>
					<p class="author">- Lyn R.</p>
				</div>
				<div class="testimonial-slide">
					<p>"I've really enjoyed working with Dan as my maths tutor over the past couple of months. The sessions have been really helpful and supportive, and I feel so much more confident in my maths now. I'm really grateful for the progress I've made and would definitely recommend Dan to anyone looking for a great maths tutor."</p>
					<p class="author">- Vi L.</p>
				</div>
				<div class="testimonial-slide">
					<p>"I enjoyed my sessions with Dan a lot, he really helped with my general understanding of physics as well as how to answer exam questions. Overall I would definitely recommend Dan as he is also a very nice person to talk to as work with."</p>
					<p class="author">- Callum C.</p>
				</div>
				<div class="testimonial-slide">
					<p>"Dan has been tutoring me for a few months now, and he's been amazing. We cover all the sciences and maths, which is really helpful when the teachers at school arenâ€™t very clear. Each lesson, I choose one of the four subjects to focus on, and we go over things I find difficult or that would be useful for future exams. What I like most is that he never makes me feel bad for not knowing something or getting a question wrong. Instead, we work together to find ways to help me remember how to solve it or structure an answer."</p>
					<p class="author">- Mina J.</p>
				</div>
				<div class="testimonial-slide">
					<p>"During my GCSEs Dan was an absolute life-saver! I was really struggling with my physics at GCSE level however once Dan came along I started to understand the content more and even delve into more information my teacher hadnâ€™t introduced me to. Without him I really struggled with physics and couldnâ€™t get my head round it however over time he helped me grasp the idea of physics and the content within, eventually resulting to my 9-9 in physics. Heâ€™s an amazing tutor and such a lovely person we always have great conversations alongside my learning! I canâ€™t wait to continue working with him at a levels I couldnâ€™t recommend him anymore!"</p>
					<p class="author">- Evan C.</p>
				</div>
				<div class="testimonial-slide">
					<p>"Thank-you for all your help running up to my A level. You were able to make me understand things clearer and I felt more confident going into my exam. I was able to achieve 2 grades higher than what I was predicted. Thanks again and I would highly recommend you to other students."</p>
					<p class="author">- Evie D.</p>
				</div>
			</div>
		</div>
		<div class="carousel-nav">
			<button id="prevBtn" class="carousel-button">â€¹</button>
			<button id="nextBtn" class="carousel-button">â€º</button>
		</div>
		<Footer />
	</body>
</html>

<style>
	main {
		color: #2c4fb9;
	}
	h1 {
		color: #2c4fb9 !important;
	}
	.tagline {
		font-size: 1.5em;
		font-weight: bold;
	}

	/* --- Carousel Styles --- */
	.carousel-container {
		/* REMOVED max-width and margin: auto to make it full-width */
		width: 100%; 
		margin: 2em 0; /* Changed to top/bottom margin only */
		overflow: hidden;
		box-sizing: border-box;
	}

	.testimonial-track {
		display: flex;
	}

	.testimonial-slide {
		/* UPDATED flex-basis to control slide width more explicitly */
		flex: 0 0 60%; /* Each slide is 60% of the viewport width */
		max-width: 600px; /* Added max-width for very large screens */
		padding: 1.5em;
		text-align: center;
		border: 1px solid #ddd;
		border-radius: 8px;
		margin: 0 10px; /* CHANGED to have margin on both sides */
	}
	
	.testimonial-slide p {
		font-style: italic;
	}

	.testimonial-slide .author {
		font-weight: bold;
		font-style: normal;
		margin-top: 1em;
	}

	.carousel-nav {
		text-align: center;
		margin-top: 1em;
	}

	.carousel-button {
		background-color: #2c4fb9;
		color: white;
		border: none;
		font-size: 1.5em;
		cursor: pointer;
		border-radius: 50%;
		width: 45px;
		height: 45px;
		margin: 0 10px;
		transition: background-color 0.3s;
	}
	
	.carousel-button:hover {
		background-color: #1a327b;
	}

	/* --- Tablet Responsive Styles --- */
	@media (max-width: 768px) {
		.testimonial-slide {
			flex-basis: 80%; /* Slide is wider on tablets */
			margin: 0 10px;
		}
	}

	/* --- Mobile Responsive Styles --- */
	@media (max-width: 480px) {
		.testimonial-slide {
			flex-basis: 90%; /* Slide is almost full-width on mobile */
			margin: 0 5px;
		}
	}
</style>

<script>
	document.addEventListener('DOMContentLoaded', () => {
		const container = document.querySelector('.carousel-container');
		const track = document.querySelector('.testimonial-track');
		const prevButton = document.getElementById('prevBtn');
		const nextButton = document.getElementById('nextBtn');
		
		if (!track || !container) return;

		let slides = Array.from(track.children);
		const originalSlideCount = slides.length;
		let isTransitioning = false;
		
		const clonesCount = 2;

		for (let i = 0; i < clonesCount; i++) {
			const index = originalSlideCount - 1 - i;
			const clone = slides[index].cloneNode(true);
			clone.classList.add('clone');
			track.insertBefore(clone, slides[0]);
		}
		for (let i = 0; i < clonesCount; i++) {
			const clone = slides[i].cloneNode(true);
			clone.classList.add('clone');
			track.appendChild(clone);
		}

		slides = Array.from(track.children);
		let currentIndex = clonesCount;

		// --- NEW: Autoplay variables ---
		let autoPlayInterval;
		const autoPlayDelay = 10000; // 10 seconds

		const getSlideWidth = () => {
			const slide = slides[0];
			if (!slide) return 0;
			const slideStyle = window.getComputedStyle(slide);
			const slideMarginRight = parseInt(slideStyle.marginRight, 10);
			return slide.clientWidth + slideMarginRight;
		};

		const setPosition = (instant = false) => {
			if (instant) track.style.transition = 'none';
			
			const offset = -currentIndex * getSlideWidth();
			track.style.transform = `translateX(${offset}px)`;

			if (instant) {
				setTimeout(() => {
					track.style.transition = 'transform 0.5s ease-in-out';
				}, 50);
			}
		};
		
		const moveToNext = () => {
			if (isTransitioning) return;
			isTransitioning = true;
			currentIndex++;
			setPosition();
		};
		
		const moveToPrev = () => {
			if (isTransitioning) return;
			isTransitioning = true;
			currentIndex--;
			setPosition();
		};

		// --- NEW: Autoplay functions ---
		const startAutoPlay = () => {
			// Clear any old interval to prevent it from running multiple times
			clearInterval(autoPlayInterval);
			// Start a new interval
			autoPlayInterval = setInterval(() => {
				moveToNext();
			}, autoPlayDelay);
		};

		// --- UPDATED: Event listeners now reset the autoplay timer ---
		nextButton.addEventListener('click', () => {
			moveToNext();
			startAutoPlay(); // Reset timer on manual click
		});

		prevButton.addEventListener('click', () => {
			moveToPrev();
			startAutoPlay(); // Reset timer on manual click
		});

		track.addEventListener('transitionend', () => {
			if (currentIndex >= originalSlideCount + clonesCount) {
				currentIndex = clonesCount;
				setPosition(true);
			}
			if (currentIndex < clonesCount) {
				currentIndex = originalSlideCount + clonesCount - 1;
				setPosition(true);
			}
			isTransitioning = false;
		});

		// --- NEW: Pause autoplay on hover ---
		container.addEventListener('mouseenter', () => {
			clearInterval(autoPlayInterval);
		});

		container.addEventListener('mouseleave', () => {
			startAutoPlay();
		});


		// --- Initial setup ---
		setPosition(true);
		startAutoPlay(); // Start the automatic sliding when the page loads
		window.addEventListener('resize', () => {
			setPosition(true);
			startAutoPlay(); // Reset on resize as well
		});
	});
</script>